!function(e,n){"function"==typeof define&&define.amd?define(["raphael"],function(t){return e.JustGage=n(t)}):"object"==typeof module&&module.exports?module.exports=e.JustGage=n(require("raphael")):e.JustGage=n(Raphael)}("undefined"!=typeof window?window:this,function(y){function t(t){var p=this;if(p.events={},S(t))return console.log("* justgage: Make sure to pass options to the constructor!"),!1;if(S(t.id)){if(S(t.parentNode))return console.log("* justgage: Make sure to pass the existing element id or parentNode to the constructor."),!1;p.node=t.parentNode}else if(p.node=document.getElementById(t.id),!p.node)return console.log("* justgage: No element with id : %s found",t.id),!1;var e,n,i,o,a,l,r,c,f,m,s,g,u,d,h=p.node.dataset||{},x=!S(t.defaults)&&t.defaults;!1!==x&&delete(t=function(t){t=t||{};for(var e=1;e<arguments.length;e++)if(arguments[e])for(var n in arguments[e])arguments[e].hasOwnProperty(n)&&(t[n]=arguments[e][n]);return t}({},t,x)).defaults,p.config={id:t.id,value:F("value",t,h,0,"float"),defaults:F("defaults",t,h,0,!1),parentNode:F("parentNode",t,h,null),width:F("width",t,h,null),height:F("height",t,h,null),valueFontColor:F("valueFontColor",t,h,"#010101"),valueFontFamily:F("valueFontFamily",t,h,"Arial"),symbol:F("symbol",t,h,""),min:F("min",t,h,0,"float"),minTxt:F("minTxt",t,h,!1),max:F("max",t,h,100,"float"),maxTxt:F("maxTxt",t,h,!1),reverse:F("reverse",t,h,!1),humanFriendlyDecimal:F("humanFriendlyDecimal",t,h,0),textRenderer:F("textRenderer",t,h,null),onAnimationEnd:F("onAnimationEnd",t,h,null),gaugeWidthScale:F("gaugeWidthScale",t,h,1),gaugeColor:F("gaugeColor",t,h,"#edebeb"),label:F("label",t,h,""),labelFontColor:F("labelFontColor",t,h,"#b3b3b3"),labelFontFamily:F("labelFontFamily",t,h,"Arial"),shadowOpacity:F("shadowOpacity",t,h,.2),shadowSize:F("shadowSize",t,h,5),shadowVerticalOffset:F("shadowVerticalOffset",t,h,3),levelColors:F("levelColors",t,h,["#a9d70b","#f9c802","#ff0000"],"array"),startAnimationTime:F("startAnimationTime",t,h,700),startAnimationType:F("startAnimationType",t,h,">"),refreshAnimationTime:F("refreshAnimationTime",t,h,700),refreshAnimationType:F("refreshAnimationType",t,h,">"),donutStartAngle:F("donutStartAngle",t,h,90),valueMinFontSize:F("valueMinFontSize",t,h,16),labelMinFontSize:F("labelMinFontSize",t,h,10),minLabelMinFontSize:F("minLabelMinFontSize",t,h,10),maxLabelMinFontSize:F("maxLabelMinFontSize",t,h,10),hideValue:F("hideValue",t,h,!1),hideMinMax:F("hideMinMax",t,h,!1),showInnerShadow:F("showInnerShadow",t,h,!1),humanFriendly:F("humanFriendly",t,h,!1),noGradient:F("noGradient",t,h,!1),donut:F("donut",t,h,!1),relativeGaugeSize:F("relativeGaugeSize",t,h,!1),counter:F("counter",t,h,!1),decimals:F("decimals",t,h,0),customSectors:F("customSectors",t,h,{}),formatNumber:F("formatNumber",t,h,!1),pointer:F("pointer",t,h,!1),pointerOptions:F("pointerOptions",t,h,{}),displayRemaining:F("displayRemaining",t,h,!1)},p.config.value>p.config.max&&(p.config.value=p.config.max),p.config.value<p.config.min&&(p.config.value=p.config.min),p.originalValue=F("value",t,h,-1,"float"),null!==p.config.id&&null!==document.getElementById(p.config.id)?p.canvas=y(p.config.id,"100%","100%"):null!==p.config.parentNode&&(p.canvas=y(p.config.parentNode,"100%","100%")),x=!0===p.config.relativeGaugeSize?!0===p.config.donut?(p.canvas.setViewBox(0,0,200,200,!0),e=200):(p.canvas.setViewBox(0,0,200,100,!0),e=200,100):null!==p.config.width&&null!==p.config.height?(e=p.config.width,p.config.height):null!==p.config.parentNode?(p.canvas.setViewBox(0,0,200,100,!0),e=200,100):(e=+T(document.getElementById(p.config.id),"width").slice(0,-2),+T(document.getElementById(p.config.id),"height").slice(0,-2)),b=(h=(t=!0===p.config.donut?(x<e?n=i=x:i=n=e,a=(x-i)/2,l=16<i/6.4?i/5.4:18,m=r=(o=(e-n)/2)+n/2,s=(c=""!==p.config.label?a+i/1.85:a+i/1.7)+(f=10<i/16?i/16:10),g=10<i/16?i/16:10,u=o+n/10+n/6.666666666666667*p.config.gaugeWidthScale/2,d=s,10<i/16?i/16:10):(x<e?e<(n=2*(i=x))&&(n/=b=n/e,i/=b):i=e<x?(n=e)/2:.5*(n=e),o=(e-n)/2,a=(x-i)/2,l=i/6.5>p.config.valueMinFontSize?i/6.5:p.config.valueMinFontSize,r=o+n/2,c=a+i/1.275,f=i/16>p.config.labelMinFontSize?i/16:p.config.labelMinFontSize,m=o+n/2,s=c+l/2+5,g=i/16>p.config.minLabelMinFontSize?i/16:p.config.minLabelMinFontSize,u=o+n/10+n/6.666666666666667*p.config.gaugeWidthScale/2,d=s,i/16>p.config.maxLabelMinFontSize?i/16:p.config.maxLabelMinFontSize),o+n-n/10-n/6.666666666666667*p.config.gaugeWidthScale/2),s),p.params={canvasW:e,canvasH:x,widgetW:n,widgetH:i,dx:o,dy:a,valueFontSize:l,valueX:r,valueY:c,labelFontSize:f,labelX:m,labelY:s,minFontSize:g,minX:u,minY:d,maxFontSize:t,maxX:h,maxY:b},b=null,p.canvas.customAttributes.pki=function(t){var e,n,i,o,a,l,r=p.config.min,c=p.config.max,f=p.params.widgetW,m=p.params.widgetH,s=p.params.dx,g=p.params.dy,u=p.config.gaugeWidthScale,d=p.config.donut;p.config.reverse;return r<0&&(c-=r,t-=r,r=0),d?(e=(1-2*(t-r)/(c-r))*Math.PI,l="M"+((o=f/2+s)-(i=(n=f/2-f/30)-f/6.666666666666667*u))+","+(a=m/2+g)+" ",l+="L"+(o-n)+","+a+" ",(c-r)/2<t-r&&(l+="A"+n+","+n+" 0 0 1 "+(o+n)+","+a+" "),l+="A"+n+","+n+" 0 0 1 "+(o+n*Math.cos(e))+","+(a-n*Math.sin(e))+" ",l+="L"+(o+i*Math.cos(e))+","+(a-i*Math.sin(e))+" ",(c-r)/2<t-r&&(l+="A"+i+","+i+" 0 0 0 "+(o+i)+","+a+" ")):(e=(1-(t-r)/(c-r))*Math.PI,l="M"+((o=f/2+s)-(i=(n=f/2-f/10)-f/6.666666666666667*u))+","+(a=m/1.25+g)+" ",l+="L"+(o-n)+","+a+" ",l+="A"+n+","+n+" 0 0 1 "+(o+n*Math.cos(e))+","+(a-n*Math.sin(e))+" ",l+="L"+(o+i*Math.cos(e))+","+(a-i*Math.sin(e))+" "),l+="A"+i+","+i+" 0 0 0 "+(o-i)+","+a+" ",{path:l+="Z "}},p.canvas.customAttributes.ndl=function(t){var e,n,i,o=p.config.min,a=p.config.max,l=p.params.widgetW,r=p.params.widgetH,c=p.params.dx,f=p.params.dy,m=p.config.gaugeWidthScale,s=p.config.donut,g=3.5*l/100,u=l/15,d=l/100;return null!=p.config.pointerOptions.toplength&&null!=p.config.pointerOptions.toplength&&(g=p.config.pointerOptions.toplength),null!=p.config.pointerOptions.bottomlength&&null!=p.config.pointerOptions.bottomlength&&(u=p.config.pointerOptions.bottomlength),null!=p.config.pointerOptions.bottomwidth&&null!=p.config.pointerOptions.bottomwidth&&(d=p.config.pointerOptions.bottomwidth),u=(i=(c=(g=(f=(i=(c=(n=(f=(m=s?(e=(1-2*(t-o)/(a-o))*Math.PI,i=(n=l/2-l/30)-l/6.666666666666667*m,r/2+f):(e=(1-(t-o)/(a-o))*Math.PI,i=(n=l/2-l/10)-l/6.666666666666667*m,r/1.25+f),l/2+c+n*Math.cos(e)),r-(r-m)-n*Math.sin(e)),l/2+c+i*Math.cos(e)),r-(r-m)-i*Math.sin(e)),f+g*Math.cos(e)),n-g*Math.sin(e)),c-u*Math.cos(e)),i+u*Math.sin(e)),"M"+(c+d*Math.sin(e))+","+(i+d*Math.cos(e))+" "),u+="L"+(c-d*Math.sin(e))+","+(i-d*Math.cos(e))+" ",u+="L"+f+","+g+" ",{path:u+="Z "}},p.gauge=p.canvas.path().attr({stroke:"none",fill:p.config.gaugeColor,pki:[p.config.max]}),p.level=p.canvas.path().attr({stroke:"none",fill:w(p.config.value,(p.config.value-p.config.min)/(p.config.max-p.config.min),p.config.levelColors,p.config.noGradient,p.config.customSectors),pki:[p.config.min]}),p.config.donut&&p.level.transform("r"+p.config.donutStartAngle+", "+(p.params.widgetW/2+p.params.dx)+", "+(p.params.widgetH/2+p.params.dy)),p.config.pointer&&(p.needle=p.canvas.path().attr({stroke:S(p.config.pointerOptions.stroke)?"none":p.config.pointerOptions.stroke,"stroke-width":S(p.config.pointerOptions.stroke_width)?0:p.config.pointerOptions.stroke_width,"stroke-linecap":S(p.config.pointerOptions.stroke_linecap)?"square":p.config.pointerOptions.stroke_linecap,fill:S(p.config.pointerOptions.color)?"#000000":p.config.pointerOptions.color,ndl:[p.config.min]}),p.config.donut&&p.needle.transform("r"+p.config.donutStartAngle+", "+(p.params.widgetW/2+p.params.dx)+", "+(p.params.widgetH/2+p.params.dy))),p.txtValue=p.canvas.text(p.params.valueX,p.params.valueY,0),p.txtValue.attr({"font-size":p.params.valueFontSize,"font-weight":"bold","font-family":p.config.valueFontFamily,fill:p.config.valueFontColor,"fill-opacity":"0"}),A(p.txtValue,p.params.valueFontSize,p.params.valueY),p.txtLabel=p.canvas.text(p.params.labelX,p.params.labelY,p.config.label),p.txtLabel.attr({"font-size":p.params.labelFontSize,"font-weight":"normal","font-family":p.config.labelFontFamily,fill:p.config.labelFontColor,"fill-opacity":"0"}),A(p.txtLabel,p.params.labelFontSize,p.params.labelY);var b=p.config.min;p.config.reverse&&(b=p.config.max),p.txtMinimum=b,p.config.minTxt?p.txtMinimum=p.config.minTxt:p.config.humanFriendly?p.txtMinimum=z(b,p.config.humanFriendlyDecimal):p.config.formatNumber&&(p.txtMinimum=V(b)),p.txtMin=p.canvas.text(p.params.minX,p.params.minY,p.txtMinimum),p.txtMin.attr({"font-size":p.params.minFontSize,"font-weight":"normal","font-family":p.config.labelFontFamily,fill:p.config.labelFontColor,"fill-opacity":p.config.hideMinMax||p.config.donut?"0":"1"}),A(p.txtMin,p.params.minFontSize,p.params.minY),b=p.config.max,p.config.reverse&&(b=p.config.min),p.txtMaximum=b,p.config.maxTxt?p.txtMaximum=p.config.maxTxt:p.config.humanFriendly?p.txtMaximum=z(b,p.config.humanFriendlyDecimal):p.config.formatNumber&&(p.txtMaximum=V(b)),p.txtMax=p.canvas.text(p.params.maxX,p.params.maxY,p.txtMaximum),p.txtMax.attr({"font-size":p.params.maxFontSize,"font-weight":"normal","font-family":p.config.labelFontFamily,fill:p.config.labelFontColor,"fill-opacity":p.config.hideMinMax||p.config.donut?"0":"1"}),A(p.txtMax,p.params.maxFontSize,p.params.maxY);var v=p.canvas.canvas.childNodes[1],M="http://www.w3.org/2000/svg";"undefined"!==C&&C<9||("undefined"!==C?function t(e){void 0!==document.createElementNS?e():setTimeout(function(){t(e)},100)}(function(){p.generateShadow(M,v)}):p.generateShadow(M,v)),M=null,p.config.textRenderer?p.originalValue=p.config.textRenderer(p.originalValue):p.config.humanFriendly?p.originalValue=z(p.originalValue,p.config.humanFriendlyDecimal)+p.config.symbol:p.config.formatNumber?p.originalValue=V(p.originalValue)+p.config.symbol:p.config.displayRemaining?p.originalValue=(p.config.max-p.originalValue).toFixed(p.config.decimals)+p.config.symbol:p.originalValue=(+p.originalValue).toFixed(p.config.decimals)+p.config.symbol,!0===p.config.counter?(this.bindEvent("raphael.anim.finish",function(){p.txtValue.attr({text:p.originalValue}),A(p.txtValue,p.params.valueFontSize,p.params.valueY)}),this.bindEvent("raphael.anim.frame",function(){var t=p.level.attr("pki")[0];p.config.reverse&&(t=+p.config.max+ +p.config.min-+p.level.attr("pki")[0]),p.config.textRenderer?p.txtValue.attr("text",p.config.textRenderer(Math.floor(t))):p.config.humanFriendly?p.txtValue.attr("text",z(Math.floor(t),p.config.humanFriendlyDecimal)+p.config.symbol):p.config.formatNumber?p.txtValue.attr("text",V(Math.floor(t))+p.config.symbol):p.config.displayRemaining?p.txtValue.attr("text",(p.config.max-t).toFixed(p.config.decimals)+p.config.symbol):p.txtValue.attr("text",(+t).toFixed(p.config.decimals)+p.config.symbol),A(p.txtValue,p.params.valueFontSize,p.params.valueY),t=null})):this.bindEvent("raphael.anim.start",function(){p.txtValue.attr({text:p.originalValue}),A(p.txtValue,p.params.valueFontSize,p.params.valueY)}),b=p.config.value,p.config.reverse&&(b=+p.config.max+ +p.config.min-+p.config.value),p.level.animate({pki:[b]},p.config.startAnimationTime,p.config.startAnimationType,p.config.onAnimationEnd),p.config.pointer&&p.needle.animate({ndl:[b]},p.config.startAnimationTime,p.config.startAnimationType),p.txtValue.animate({"fill-opacity":p.config.hideValue?"0":"1"},p.config.startAnimationTime,p.config.startAnimationType),p.txtLabel.animate({"fill-opacity":"1"},p.config.startAnimationTime,p.config.startAnimationType)}function i(t,e,n){switch(e){case"valueFontColor":if(!o(n)){console.log("* justgage: the updated valueFontColor value is not a valid hex color");break}t.txtValue.attr({fill:n});break;case"labelFontColor":if(!o(n)){console.log("* justgage: the updated labelFontColor value is not a valid hex color");break}t.txtMin.attr({fill:n}),t.txtMax.attr({fill:n}),t.txtLabel.attr({fill:n});break;default:console.log('* justgage: "${option}" is not a supported update setting')}}function F(t,e,n,i,o){var a=i,l=!1;if(!S(t)&&(!S(n)&&"object"==typeof n&&t in n?(a=n[t],l=!0):!S(e)&&"object"==typeof e&&t in e?(a=e[t],l=!0):a=i,!0===l&&!S(o)))switch(o){case"int":a=parseInt(a,10);break;case"float":a=parseFloat(a)}return a}function S(t){return null==t}function w(t,e,n,i,o){var a,l,r,c,f,m,s,g,u,d,p=o&&o.ranges&&0<o.ranges.length,i=i||p;if(p){!0===o.percents&&(t=100*e);for(var h=0;h<o.ranges.length;h++)if(t>=o.ranges[h].lo&&t<=o.ranges[h].hi)return o.ranges[h].color}if(1===(p=n.length))return n[0];for(a=i?1/p:1/(p-1),l=[],h=0;h<n.length;h++)r=i?a*(h+1):a*h,c=parseInt(b(n[h]).substring(0,2),16),f=parseInt(b(n[h]).substring(2,4),16),m=parseInt(b(n[h]).substring(4,6),16),l[h]={pct:r,color:{r:c,g:f,b:m}};if(0===e)return"rgb("+[l[0].color.r,l[0].color.g,l[0].color.b].join(",")+")";for(var x=0;x<l.length;x++)if(e<=l[x].pct)return i?"rgb("+[l[x].color.r,l[x].color.g,l[x].color.b].join(",")+")":(s=l[x-1],u=(g=l[x]).pct-s.pct,u=1-(d=(e-s.pct)/u),d=d,"rgb("+[(d={r:Math.floor(s.color.r*u+g.color.r*d),g:Math.floor(s.color.g*u+g.color.g*d),b:Math.floor(s.color.b*u+g.color.b*d)}).r,d.g,d.b].join(",")+")")}function A(t){(!C||9<C)&&t.node.firstChild.attributes.dy&&(t.node.firstChild.attributes.dy.value=0)}function b(t){return"#"==t.charAt(0)?t.substring(1,7):t}function o(t){return"string"==typeof t&&/^#([0-9A-Fa-f]{3}){1,2}$/.test(t)}function z(t,e){for(var e=Math.pow(10,e),n=" KMGTPE",i=0;(1e3<=t||t<=-1e3)&&++i<n.length;)t/=1e3;return i=n.length<=i?n.length-1:i,Math.round(t*e)/e+n[i]}function V(t){t=t.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function T(t,e){var n="";return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,"").getPropertyValue(e):t.currentStyle&&(e=e.replace(/\-(\w)/g,function(t,e){return e.toUpperCase()}),n=t.currentStyle[e]),n}t.prototype.bindEvent=function(t,e){t+="."+this.level.id,this.events[t]&&y.eve.off(t,this.events[t]),y.eve.on(t,e),this.events[t]=e},t.prototype.refresh=function(t,e,n,i){var o=this;e=e||null,n=n||null,null!==(i=i||null)&&(o.config.label=i,o.txtLabel.attr({text:o.config.label}),A(o.txtLabel,o.params.labelFontSize,o.params.labelY)),null!==n&&(o.config.min=n,o.txtMinimum=o.config.min,o.config.minTxt?o.txtMinimum=o.config.minTxt:o.config.humanFriendly?o.txtMinimum=z(o.config.min,o.config.humanFriendlyDecimal):o.config.formatNumber&&(o.txtMinimum=V(o.config.min)),o.config.reverse?(o.txtMax.attr({text:o.txtMinimum}),A(o.txtMax,o.params.minFontSize,o.params.minY)):(o.txtMin.attr({text:o.txtMinimum}),A(o.txtMin,o.params.minFontSize,o.params.minY))),null!==e&&(o.config.max=e,o.txtMaximum=o.config.max,o.config.maxTxt?o.txtMaximum=o.config.maxTxt:o.config.humanFriendly?o.txtMaximum=z(o.config.max,o.config.humanFriendlyDecimal):o.config.formatNumber&&(o.txtMaximum=V(o.config.max)),o.config.reverse?(o.txtMin.attr({text:o.txtMaximum}),A(o.txtMin,o.params.maxFontSize,o.params.maxY)):(o.txtMax.attr({text:o.txtMaximum}),A(o.txtMax,o.params.maxFontSize,o.params.maxY))),+(i=t)>+o.config.max&&(t=+o.config.max),+t<+o.config.min&&(t=+o.config.min),e=w(t,(t-o.config.min)/(o.config.max-o.config.min),o.config.levelColors,o.config.noGradient,o.config.customSectors),i=o.config.textRenderer?o.config.textRenderer(i):o.config.humanFriendly?z(i,o.config.humanFriendlyDecimal)+o.config.symbol:o.config.formatNumber?V((+i).toFixed(o.config.decimals))+o.config.symbol:o.config.displayRemaining?(o.config.max-i).toFixed(o.config.decimals)+o.config.symbol:(+i).toFixed(o.config.decimals)+o.config.symbol,o.originalValue=i,o.config.value=+t,o.config.counter||(o.txtValue.attr({text:i}),A(o.txtValue,o.params.valueFontSize,o.params.valueY));i=o.config.value;o.config.reverse&&(i=+o.config.max+ +o.config.min-+o.config.value),o.level.animate({pki:[i],fill:e},o.config.refreshAnimationTime,o.config.refreshAnimationType,o.config.onAnimationEnd),o.config.pointer&&o.needle.animate({ndl:[i]},o.config.refreshAnimationTime,o.config.refreshAnimationType),n=null},t.prototype.update=function(t,e){if(t instanceof Object)for(var n in t)i(this,n,e=t[n]);else i(this,t,e)},t.prototype.destroy=function(){for(var t in this.node&&this.node.parentNode&&(this.node.innerHTML=""),this.events)y.eve.off(t,this.events[t]);this.events={}},t.prototype.generateShadow=function(t,e){var n=this,i="inner-shadow-"+n.config.id,o=document.createElementNS(t,"filter");o.setAttribute("id",i),e.appendChild(o),(e=document.createElementNS(t,"feOffset")).setAttribute("dx",0),e.setAttribute("dy",n.config.shadowVerticalOffset),o.appendChild(e),(e=document.createElementNS(t,"feGaussianBlur")).setAttribute("result","offset-blur"),e.setAttribute("stdDeviation",n.config.shadowSize),o.appendChild(e),(e=document.createElementNS(t,"feComposite")).setAttribute("operator","out"),e.setAttribute("in","SourceGraphic"),e.setAttribute("in2","offset-blur"),e.setAttribute("result","inverse"),o.appendChild(e),(e=document.createElementNS(t,"feFlood")).setAttribute("flood-color","black"),e.setAttribute("flood-opacity",n.config.shadowOpacity),e.setAttribute("result","color"),o.appendChild(e),(e=document.createElementNS(t,"feComposite")).setAttribute("operator","in"),e.setAttribute("in","color"),e.setAttribute("in2","inverse"),e.setAttribute("result","shadow"),o.appendChild(e),(t=document.createElementNS(t,"feComposite")).setAttribute("operator","over"),t.setAttribute("in","shadow"),t.setAttribute("in2","SourceGraphic"),o.appendChild(t),n.config.showInnerShadow&&(n.canvas.canvas.childNodes[2].setAttribute("filter","url("+window.location.pathname+"#"+i+")"),n.canvas.canvas.childNodes[3].setAttribute("filter","url("+window.location.pathname+"#"+i+")")),t=null};var C=function(){for(var t=3,e=document.createElement("div"),n=e.getElementsByTagName("i");e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e",n[0];);return 4<t?t:void 0}();return t});